{% extends 'mailing_list/base.html' %}

{% load static %}

{% block body %}
<body class="lti-tool"
      role="application"
      ng-controller="MailingListController as ml">
  <header>
    <h1>
      {% block breadcrumbs %}Course Mailing List{% endblock breadcrumbs %}
    </h1>
  </header>
  <div class="loading-indicator" ng-show="ml.isLoading">
    <img src="{% static 'images/ajax-loader-large.gif' %}"/>
  </div>
  <main class="ng-hide" ng-show="ml.loaded">
    <div id="main-section" ng-show="ml.hasPrimarySections()">
      <div ng-repeat="list in ml.primarySectionLists">
        {% verbatim %}
        <h2 class="all-members" ng-show="$first">
          <a class="semi-underline" href="{{ ml.listMembersUrl(list) }}">
            <span>
              View course members' email addresses
            </span>
            ({{ list.members_count }} members)
            
          </a>
        </h2>
        
        <div class="main-section-content">
          <h2>
            {{ ml.primarySectionLists[0].name }} mailing list address
          </h2>
          <div class="listerv-content">
            <p class="caption-secondary">
              The mailing list contains teaching staff, students, and others
              who have been added to this course.
            </p>
            {% endverbatim %}
            <div class="content-section">
              {% include "mailing_list/_mailing_list_details.html" with scope="class" %}
            </div>
          </div>
        </div>

      </div>
    </div>
    <div id="course-sections" ng-show="!ml.hasPrimarySections()">
      <p>
        There was an error retrieving the class mailing list for this course.
        Please contact your local academic support staff for assistance.
      </p>
    </div>

    <div ng-show="ml.hasOtherSections()">
      <h2>
        {% verbatim %}{{ ml.primarySectionLists[0].name }}{% endverbatim %}
        sections mailing list addresses
      </h2>
      <div class="listerv-content">
        <p class="caption-secondary">
          These sections are created in the Manage Sections tool (if installed
          in your account) or are being sent from the Registrar's Office.
          Any changes made to those sections will be reflected within these lists.
        </p>
        <div id="course-sections">
          <div ng-repeat="list in ml.otherSectionLists" class="content-section">
            {% include "mailing_list/_mailing_list_details.html" with scope="section" %}
          </div>
        </div>
      </div>
    </div>
  </main>
</body>
{% endblock body %}
